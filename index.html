<!DOCTYPE HTML>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        html,body {
            padding: initial !important;
            margin: 10px !important;
        }
            h1,h2,h3,h4,h5,h6 {
                text-align:center;
                width:100%;
            }
            p {
                margin:10px;
            }
            h1 {
                text-decoration:underline;
            }
            * {
                font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif
                
            }
            @keyframes fade-in {
                0% { transform:translateY(100%);opacity:0;}
                85% { transform:translate(-2px);opacity:1}
                100% {transform:translateY(0%);opacity:1;}
            }
            @-webkit-keyframes fade-in {
                0% { -webkit-transform:translateY(100%);opacity:0;}
                85% {-webkit-transform:translateY(-2px);opacity:1;}
                100% {-webkit-transform:translateY(0%);opacity:1;}
            }
            .fade-in {
                animation:2s fade-in ease-in-out ;
                -webkit-animation:2s fade-in ease-in-out;
              
                opacity:1;
            }
            
        </style>
    </head>
    <body onload="start()">
        <script src="//cdn.jsdelivr.net/npm/eruda"></script>
<script>eruda.init();</script>
        <script src="codemirror.js"></script>
        <script src="process.js"></script>
        <script src="buffer.js"></script>
        <script src="stylelint.js" onerror = "console.log('fail')"></script>
        <script src="bodybuilder.js" onerror="alert('could not load')"></script>
    <script>
        async function lint(input, opts) {
    let output = undefined
    if (!opts) {
        opts = {
            "rules": {
                "annotation-no-unknown": true,
                "at-rule-no-unknown": true,
                "block-no-empty": true,
                "color-no-invalid-hex": true,
                "comment-no-empty": true,
                "custom-property-no-missing-var-function": true,
                "declaration-block-no-duplicate-custom-properties": true,
                "declaration-block-no-duplicate-properties": [
                    true,
                    {
                        "ignore": [
                            "consecutive-duplicates-with-different-values"
                        ]
                    }
                ],
                "declaration-block-no-shorthand-property-overrides": true,
                "font-family-no-duplicate-names": true,
                "font-family-no-missing-generic-family-keyword": true,
                "function-calc-no-unspaced-operator": true,
                "function-linear-gradient-no-nonstandard-direction": true,
                "function-no-unknown": false,
                "keyframe-block-no-duplicate-selectors": true,
                "keyframe-declaration-no-important": true,
                "media-feature-name-no-unknown": true,
                "named-grid-areas-no-invalid": true,
                "no-descending-specificity": true,
                "no-duplicate-at-import-rules": true,
                "no-duplicate-selectors": true,
                "no-empty-source": true,
                "no-extra-semicolons": true,
                "no-invalid-double-slash-comments": true,
                "no-invalid-position-at-import-rule": true,
                "no-irregular-whitespace": true,
                "property-no-unknown": true,
                "selector-pseudo-class-no-unknown": true,
                "selector-pseudo-element-no-unknown": true,
                "selector-type-no-unknown": [
                    true,
                    {
                        "ignore": [
                            "custom-elements"
                        ]
                    }
                ],
                "string-no-newline": true,
                "unit-no-unknown": true,
                "alpha-value-notation": [
                    "percentage",
                    {
                        "exceptProperties": [
                            "opacity",
                            "fill-opacity",
                            "flood-opacity",
                            "stop-opacity",
                            "stroke-opacity"
                        ]
                    }
                ],
                "at-rule-empty-line-before": [
                    "always",
                    {
                        "except": [
                            "blockless-after-same-name-blockless",
                            "first-nested"
                        ],
                        "ignore": [
                            "after-comment"
                        ]
                    }
                ],
                "at-rule-name-case": "lower",
                "at-rule-name-space-after": "always-single-line",
                "at-rule-no-vendor-prefix": true,
                "at-rule-semicolon-newline-after": "always",
                "block-closing-brace-empty-line-before": "never",
                "block-closing-brace-newline-after": "always",
                "block-closing-brace-newline-before": "never",
                "block-closing-brace-space-before": "always-single-line",
                "block-opening-brace-newline-after": "always-multi-line",
                "block-opening-brace-space-after": "always-single-line",
                "block-opening-brace-space-before": "always",
                "color-function-notation": "modern",
                "color-hex-case": "lower",
                "color-hex-length": "short",
                "comment-empty-line-before": [
                    "always",
                    {
                        "except": [
                            "first-nested"
                        ],
                        "ignore": [
                            "stylelint-commands"
                        ]
                    }
                ],
                "comment-whitespace-inside": "always",
                "custom-property-empty-line-before": [
                    "always",
                    {
                        "except": [
                            "after-custom-property",
                            "first-nested"
                        ],
                        "ignore": [
                            "after-comment",
                            "inside-single-line-block"
                        ]
                    }
                ],
                "custom-media-pattern": [
                    "^([a-z][a-z0-9]*)(-[a-z0-9]+)*$",
                    {
                        "message": "Expected custom media query name to be kebab-case"
                    }
                ],
                "custom-property-pattern": [
                    "^([a-z][a-z0-9]*)(-[a-z0-9]+)*$",
                    {
                        "message": "Expected custom property name to be kebab-case"
                    }
                ],
                "declaration-bang-space-after": "never",
                "declaration-bang-space-before": "always",
                "declaration-block-semicolon-newline-after": "always-multi-line",
                "declaration-block-semicolon-space-after": "always-single-line",
                "declaration-block-semicolon-space-before": "never",
                "declaration-block-single-line-max-declarations": 1,
                "declaration-block-trailing-semicolon": "always",
                "declaration-block-no-redundant-longhand-properties": true,
                "declaration-colon-newline-after": "always-multi-line",
                "declaration-colon-space-after": "always-single-line",
                "declaration-colon-space-before": "never",
                "declaration-empty-line-before": [
                    "always",
                    {
                        "except": [
                            "after-declaration",
                            "first-nested"
                        ],
                        "ignore": [
                            "after-comment",
                            "inside-single-line-block"
                        ]
                    }
                ],
                "font-family-name-quotes": "always-where-recommended",
                "function-comma-newline-after": "always-multi-line",
                "function-comma-space-after": "always-single-line",
                "function-comma-space-before": "never",
                "function-max-empty-lines": 0,
                "function-name-case": "lower",
                "function-parentheses-newline-inside": "always-multi-line",
                "function-parentheses-space-inside": "never-single-line",
                "function-url-quotes": "always",
                "function-whitespace-after": "always",
                "hue-degree-notation": "angle",
                "import-notation": "string",
                "indentation": 2,
                "keyframe-selector-notation": "percentage-unless-within-keyword-only-block",
                "keyframes-name-pattern": [
                    "^([a-z][a-z0-9]*)(-[a-z0-9]+)*$",
                    {
                        "message": "Expected keyframe name to be kebab-case"
                    }
                ],
                "length-zero-no-unit": true,
                "max-empty-lines": 1,
                "max-line-length": 120,
                "media-feature-colon-space-after": "always",
                "media-feature-colon-space-before": "never",
                "media-feature-name-case": "lower",
                "media-feature-name-no-vendor-prefix": true,
                "media-feature-parentheses-space-inside": "never",
                "media-feature-range-operator-space-after": "always",
                "media-feature-range-operator-space-before": "always",
                "media-query-list-comma-newline-after": "always-multi-line",
                "media-query-list-comma-space-after": "always-single-line",
                "media-query-list-comma-space-before": "never",
                "no-empty-first-line": true,
                "no-eol-whitespace": false,
                "no-missing-end-of-source-newline": false,
                "number-leading-zero": "always",
                "number-max-precision": 4,
                "number-no-trailing-zeros": true,
                "property-case": "lower",
                "property-no-vendor-prefix": true,
                "rule-empty-line-before": [
                    "always-multi-line",
                    {
                        "except": [
                            "first-nested"
                        ],
                        "ignore": [
                            "after-comment"
                        ]
                    }
                ],
                "selector-attribute-brackets-space-inside": "never",
                "selector-attribute-operator-space-after": "never",
                "selector-attribute-operator-space-before": "never",
                "selector-attribute-quotes": "always",
                "selector-class-pattern": [
                    "^([a-z][a-z0-9]*)(-[a-z0-9]+)*$",
                    {
                        "message": "Expected class selector to be kebab-case"
                    }
                ],
                "selector-combinator-space-after": "always",
                "selector-combinator-space-before": "always",
                "selector-descendant-combinator-no-non-space": true,
                "selector-id-pattern": [
                    "^([a-z][a-z0-9]*)(-[a-z0-9]+)*$",
                    {
                        "message": "Expected id selector to be kebab-case"
                    }
                ],
                "selector-list-comma-newline-after": "always",
                "selector-list-comma-space-before": "never",
                "selector-max-empty-lines": 0,
                "selector-no-vendor-prefix": true,
                "selector-not-notation": "complex",
                "selector-pseudo-class-case": "lower",
                "selector-pseudo-class-parentheses-space-inside": "never",
                "selector-pseudo-element-case": "lower",
                "selector-pseudo-element-colon-notation": "double",
                "selector-type-case": "lower",
                "shorthand-property-no-redundant-values": true,
                "string-quotes": "double",
                "unit-case": "lower",
                "value-keyword-case": "lower",
                "value-list-comma-newline-after": "always-multi-line",
                "value-list-comma-space-after": "always-single-line",
                "value-list-comma-space-before": "never",
                "value-list-max-empty-lines": 0,
                "value-no-vendor-prefix": true
            }
        }
    }


    await stylelint.lint(
        {
            config: opts,
            code: input || "",
        }
    ).then((vvv) => {
        // let str = JSON.stringify(vvv.results)
        //console.log(JSON.parse(vvv.output)[0].warnings)
        //console.log(vvv.results)
        //str = str.split(",").join(",\n")
        //document.querySelector("p").innerHTML = "";
        //document.querySelector("p").appendChild(document.createTextNode(JSON.stringify(vvv.results[0].warnings)))
        //lets format the code :)
        let errors = [];
        vvv.results[0].warnings.forEach((warning) => {
            let template = {
                line: undefined,
                col: undefined,
                endline: undefined,
                endcol: undefined,
                pos: undefined,
                endpos: undefined,
                rule: undefined,
                message: undefined,
                rawmessage: undefined,
                severity: undefined
            };
            //console.log(warning)
            function calcpos(line, col) {
                //CM SYNTAX HERE
            }
            let rule = warning.rule;
            let rule2 = ` (${warning.rule})` // to fix some rules
            //console.log(warning)
            template.rule = rule
            template.message = warning.text;
            template.rawmessage = warning.text.slice(0, warning.text.indexOf(rule2));
            template.line = warning.line;
            template.col = warning.column;
            template.endline = warning.endLine || template.line;
            template.endcol = warning.endColumn || template.col;
            template.pos = calcpos(template.line, template.col);//to be used with CODEMIRROR 6
            template.endpos = calcpos(template.endline, template.endcol) || template.pos;
            template.severity = warning.severity;
            errors.push(template)
        })

        stylelint.errors = errors;

    })
    return output;
}
        function start() {
        let body = l("body");

        body.apCh({h1:["Stylelint Front-end Application"],class:"fade-in"})
        setTimeout(()=>{
            body.apCh({
                p:["Welcome! This is the testing environment for StyleLint,enter any CSS code and the Front-end version of Stylelint will process your code!"],
                class:"fade-in"
            })
            setTimeout(()=>{
                try {
                const {basicSetup,EditorView} = CM["codemirror"];
                    console.log(CM)
                const {css} = CM["@codemirror/lang-css"];
                let codem = new EditorView(
                    {
                        doc:"",
                        parent:document.body,
                        extensions:[basicSetup,css()]
                    }
                )
                codem.dom.classList.add("fade-in")
                body.apCh({
                    p:[],
                    class:"fade-in",
                    id:"reporter"
                })
                setInterval(() => {
                    //console.log(codem.state.doc.text)
                    lint(
                        codem.state.doc.text.join("\n")
                    )
                    if (typeof stylelint.errors != 'undefined') {
                if (stylelint.errors.length) {
                    document.querySelector('p#reporter').innerHTML = "";
                    stylelint.errors.forEach((error) => {
                        let ew = document.createElement('div');
                        //console.log(error)
                        ew.className = "m-2 p-1";
                        ew.style.borderRadius = "5px"
                        ew.style.borderColor = "rgba(0,0,0,.1)";
                        ew.style.borderStyle = "solid";
                        if (error.severity == "warning") {
                            ew.classList.add('text-bg-warning')
                        } else {
                            ew.classList.add('text-bg-danger')
                        }
                        let et = document.createElement('span');
                        et.className = "badge badge-danger";
                        et.appendChild(document.createTextNode(error.rule));
                        ew.appendChild(document.createTextNode(error.rawmessage));
                        ew.appendChild(et);
                        document.querySelector('p#reporter').appendChild(ew);
                    })
                } else {
                    document.querySelector("p#reporter").innerHTML = "<strong>all good! 👍</strong>"
                }
            }
                },10)
                } catch(e) { 
                    console.log(e)
                }
            },1000)
        },1000)
        }
        /*document.addEventListener("mousemove",(event)=>{
            //console.log(event.x,event.y)
            let ch = document.body.childNodes;
            ch.forEach((value,index)=>{
                try {
                if (index > 10) {
                    let bound = value.getBoundingClientRect()
                    //console.log(bound)
                    let boundaries = {
                        x:bound.x + bound.width/2,
                        y:bound.y + bound.height/2
                    }
                    let mouse = {
                        x:event.x,
                        y:event.y,
                    }
                    console.log(boundaries,mouse)
                    // y2 - y1
                    // x2 - x1
                    //slope of line
                    let m = (boundaries.y-mouse.y)/(boundaries.x-mouse.x);
                    let my = (boundaries.y-mouse.y);
                    let mx =(boundaries.x-mouse.x);
                    
                    value.style.transform = `translate(${mx}px,${Math.cos(my)}px)`
                }
            } catch (e) {
                //console.log(e.toString(),value)
            }
            })
        })*/
    </script>
    </body>
    
</html>